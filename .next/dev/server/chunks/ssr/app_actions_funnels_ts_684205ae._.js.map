{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jimmy/Desktop/nexus-os/app/actions/funnels.ts"],"sourcesContent":["'use server'\n\nimport { auth } from \"@clerk/nextjs/server\";\nimport { prisma } from \"@/lib/prisma\";\nimport { revalidatePath } from \"next/cache\";\nimport { redirect } from \"next/navigation\";\n\nexport async function createFunnel(formData: FormData) {\n  const { userId } = await auth();\n\n  if (!userId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  const name = formData.get(\"name\") as string;\n  const description = formData.get(\"description\") as string;\n  const price = parseFloat(formData.get(\"price\") as string);\n  const headline = formData.get(\"headline\") as string;\n\n  if (!name || !price) {\n    throw new Error(\"Name and Price are required\");\n  }\n\n  try {\n    await prisma.funnel.create({\n      data: {\n        userId,\n        name,\n        description,\n        price,\n        headline: headline ? [headline] : [],\n        published: true,\n        currency: \"KES\",\n      },\n    });\n\n    revalidatePath(\"/dashboard/funnels\");\n  } catch (error) {\n    console.error(\"Database Error:\", error);\n    // In a real app, you might want to return the error to the UI\n    return { message: \"Failed to create funnel\" };\n  }\n\n  // Redirect must be outside the try/catch block\n  redirect(\"/dashboard/funnels\");\n}\r\n"],"names":[],"mappings":";;;;;AAEA;;;;;;AAEA;AACA;AAAA;;;;;;;AAEO,eAAe,aAAa,QAAkB;IACnD,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAA,2LAAI;IAE7B,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,OAAO,SAAS,GAAG,CAAC;IAC1B,MAAM,cAAc,SAAS,GAAG,CAAC;IACjC,MAAM,QAAQ,WAAW,SAAS,GAAG,CAAC;IACtC,MAAM,WAAW,SAAS,GAAG,CAAC;IAE9B,IAAI,CAAC,QAAQ,CAAC,OAAO;QACnB,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,MAAM,OAAO,MAAM,CAAC,MAAM,CAAC;YACzB,MAAM;gBACJ;gBACA;gBACA;gBACA;gBACA,UAAU,WAAW;oBAAC;iBAAS,GAAG,EAAE;gBACpC,WAAW;gBACX,UAAU;YACZ;QACF;QAEA,IAAA,+IAAc,EAAC;IACjB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mBAAmB;QACjC,8DAA8D;QAC9D,OAAO;YAAE,SAAS;QAA0B;IAC9C;IAEA,+CAA+C;IAC/C,IAAA,iMAAQ,EAAC;AACX;;;IAtCsB;;AAAA,+OAAA"}}]
}